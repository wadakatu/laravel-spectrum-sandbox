<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laravel Spectrum Sandbox - Terminal</title>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/terminal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.1.0/css/xterm.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
</head>
<body>
    <div class="sandbox-container">
        <!-- Header -->
        <div class="sandbox-header">
            <div class="header-left">
                <a href="/" class="btn btn-sm btn-outline-light">
                    <i class="bi bi-arrow-left"></i> Back
                </a>
                <span class="environment-badge" id="environment-name">Loading...</span>
            </div>
            <div class="header-center">
                <div class="btn-group" role="group">
                    <button class="btn btn-sm btn-primary" onclick="clearTerminal()">
                        <i class="bi bi-trash"></i> Clear
                    </button>
                    <button class="btn btn-sm btn-primary" onclick="resetEnvironment()">
                        <i class="bi bi-arrow-clockwise"></i> Reset
                    </button>
                    <button class="btn btn-sm btn-primary" onclick="downloadFiles()">
                        <i class="bi bi-download"></i> Download Files
                    </button>
                </div>
            </div>
            <div class="header-right">
                <span class="connection-status" id="connection-status">
                    <i class="bi bi-circle-fill"></i> Connected
                </span>
            </div>
        </div>

        <!-- Main Content -->
        <div class="sandbox-content">
            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Command Palette -->
                <div class="panel">
                    <div class="panel-header">
                        <h6><i class="bi bi-command"></i> Commands</h6>
                    </div>
                    <div class="panel-body" id="command-palette">
                        <div class="command-group">
                            <div class="command-group-title">Generation</div>
                            <button class="command-btn" onclick="runCommand('php artisan spectrum:generate')">
                                spectrum:generate
                            </button>
                            <button class="command-btn" onclick="runCommand('php artisan spectrum:generate --format=yaml')">
                                spectrum:generate --format=yaml
                            </button>
                        </div>
                        <div class="command-group">
                            <div class="command-group-title">Development</div>
                            <button class="command-btn" onclick="runCommand('php artisan spectrum:watch')">
                                spectrum:watch
                            </button>
                            <button class="command-btn" onclick="runCommand('php artisan spectrum:mock')">
                                spectrum:mock
                            </button>
                        </div>
                        <div class="command-group">
                            <div class="command-group-title">Export</div>
                            <button class="command-btn" onclick="runCommand('php artisan spectrum:export:postman')">
                                export:postman
                            </button>
                            <button class="command-btn" onclick="runCommand('php artisan spectrum:export:insomnia')">
                                export:insomnia
                            </button>
                        </div>
                        <div class="command-group">
                            <div class="command-group-title">Cache</div>
                            <button class="command-btn" onclick="runCommand('php artisan spectrum:cache:clear')">
                                cache:clear
                            </button>
                            <button class="command-btn" onclick="runCommand('php artisan spectrum:cache:stats')">
                                cache:stats
                            </button>
                        </div>
                    </div>
                </div>

                <!-- File Explorer -->
                <div class="panel">
                    <div class="panel-header">
                        <h6><i class="bi bi-folder-open"></i> Files</h6>
                        <button class="btn btn-sm btn-link" onclick="refreshFileTree()">
                            <i class="bi bi-arrow-clockwise"></i>
                        </button>
                    </div>
                    <div class="panel-body">
                        <div id="file-tree" class="file-tree">
                            <!-- Dynamically populated -->
                        </div>
                    </div>
                </div>

                <!-- Output Viewer -->
                <div class="panel">
                    <div class="panel-header">
                        <h6><i class="bi bi-file-earmark-text"></i> Output</h6>
                    </div>
                    <div class="panel-body">
                        <select class="form-select form-select-sm" id="output-selector" onchange="loadOutput()">
                            <option value="">Select output file...</option>
                            <option value="openapi.json">openapi.json</option>
                            <option value="openapi.yaml">openapi.yaml</option>
                            <option value="postman.json">postman.json</option>
                            <option value="insomnia.json">insomnia.json</option>
                        </select>
                        <div id="output-viewer" class="output-viewer mt-2">
                            <!-- Output content -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Terminal -->
            <div class="terminal-container">
                <div id="terminal"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/xterm@5.1.0/lib/xterm.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xterm-addon-fit@0.7.0/lib/xterm-addon-fit.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xterm-addon-web-links@0.8.0/lib/xterm-addon-web-links.js"></script>
    <script src="/js/terminal.js"></script>
    <script src="/js/file-explorer.js"></script>
    <script src="/js/command-palette.js"></script>
    <script src="/js/app.js"></script>
</body>
</html>